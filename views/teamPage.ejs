<%- include("partials/header.ejs") %>

<!-- NBA LOGO -->
<br />
<div class="text-center">
  <h1 class="display-2"><%= team[0].team %></h1>
  <img height="200px" width="200px" src="<%= team[0].teamLogo %>" />
</div>
<br />

<div class="container">
  <div class="container-fluid">
    <div class="row justify-content-evenly">
      <!-- PLAYER CARD -->
      <%# EJS CODE %> <% team.slice(1).forEach(function(player) { %>
      <div class="col-lg-3 col-md-3 col-sm-12 card shadow" id="playerCard">
        <% if(player.headshot){ %> <%# IF TWITTER ACCOUNT EXISTS %>
        <img class="card-img-top rounded-circle" id="playerImage" src="<%= player.headshot %>" />
        <% } else{ %>
        <img class="card-img-top rounded-circle" id="playerImage" src="/images/generic-player.png" />
        <% } %>

        <div class="card-body">
          <h5 class="card-title"><%= player.name %><span class="favorite"><i class="fa fa-star-o"></i> </span></h5>
          <h6 class="card-text"><%= player.position %> | <%= player.jersey %></h6>

          <div class="d-flex justify-content-center icon-bar">
            <% if(player.twitter){ %> <%# IF TWITTER ACCOUNT EXISTS %>
            <a class="btn btn-lg btn-social btn-twitter text-decoration-none hvr-grow" href="<%=player.twitter %>" target="_blank"><i
                class="fa fa-twitter"></i></a>
            <% } %> <% if(player.instagram){ %> <%# IF INSTAGRAM ACCOUNT EXISTS %>
            <a class="btn btn-lg btn-social text-decoration-none btn-instagram hvr-grow" href="<%=player.instagram %>" target="_blank"><i
                class="fa fa-instagram"></i></a>
            <% } %> <% if(player.facebook){ %> <%# IF FACEBOOK ACCOUNT EXISTS %>
            <a class="btn btn-lg btn-social btn-facebook text-decoration-none hvr-grow" href="<%=player.facebook %>" target="_blank"><i
                class="fa fa-facebook"></i></a>
            <% } %>
          </div>
        </div>
      </div>
      <% }); %> <%# END EJS CODE %>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>

  $(document).ready(function () {
    $('.favorite').on('click', function () {
      var player = $(this)[0].previousSibling.data;
      fetch('/favorite', {
        method: 'POST',
        headers: {
          'Accept': 'application/json, text/plain, */*',
          'CSRF-Token': Cookies.get('XSRF-TOKEN'),
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ player: player })
      }).then(response => {
        const status = response.status;

        if (status == 401) {
          console.log(status);

        }
        if (status == 200) {
          swal("Success", "Player Added", "success");
        }
      })
        .catch(err => console.log(err))
    })
  });
</script>

<%- include("partials/footer.ejs") %>